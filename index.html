<script>
(async () => {
  const ipData = await fetch('https://ipapi.co/json/').then(res => res.json());

  const visitorData = {
    ip: ipData.ip || "Unknown",
    country: ipData.country_name || "Unknown",
    region: ipData.region || "Unknown",
    city: ipData.city || "Unknown",
    org: ipData.org || "Unknown",
    userAgent: navigator.userAgent,
    language: navigator.language,
    screenSize: `${screen.width}x${screen.height}`,
    url: location.href,
    platform: navigator.platform,
    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
    localTime: new Date().toString(),
  };

  await fetch("/api/log", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(visitorData),
  });
})();
</script>
